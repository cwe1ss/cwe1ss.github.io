<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Using Flutter flavors to separate the DEV and LIVE environment - Christian Weiss</title><meta name=Description content><meta property="og:title" content="Using Flutter flavors to separate the DEV and LIVE environment"><meta property="og:description" content="These are the requirements for our app:

Our Flutter app should target iOS and Android.
We want a DEV version and a LIVE version of our app, each targeting a different API URL.
Developers should never have to manually change any code to switch between the environments.
We want to be able to have the DEV app and the LIVE app installed on the same device at the same time.

The best way to solve these requirements in Flutter is to use flavors. There are also some other tutorials for this linked on the official Flutter docs which might be helpful.
The code for this guide is stored on GitHub and changes for each section are separate commits that are linked in the section below."><meta property="og:type" content="article"><meta property="og:url" content="https://www.chwe.at/2020/10/flutter-flavors/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-03T00:00:00+01:00"><meta property="article:modified_time" content="2020-10-03T00:00:00+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Using Flutter flavors to separate the DEV and LIVE environment"><meta name=twitter:description content="These are the requirements for our app:

Our Flutter app should target iOS and Android.
We want a DEV version and a LIVE version of our app, each targeting a different API URL.
Developers should never have to manually change any code to switch between the environments.
We want to be able to have the DEV app and the LIVE app installed on the same device at the same time.

The best way to solve these requirements in Flutter is to use flavors. There are also some other tutorials for this linked on the official Flutter docs which might be helpful.
The code for this guide is stored on GitHub and changes for each section are separate commits that are linked in the section below."><meta name=application-name content="Christian Weiss"><meta name=apple-mobile-web-app-title content="Christian Weiss"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://www.chwe.at/2020/10/flutter-flavors/><link rel=prev href=https://www.chwe.at/2015/09/find-missing-projects-with-powershell/><link rel=next href=https://www.chwe.at/2020/10/zero-downtime-updates-with-aspnet-core/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Using Flutter flavors to separate the DEV and LIVE environment","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.chwe.at\/2020\/10\/flutter-flavors\/"},"genre":"posts","wordcount":2669,"url":"https:\/\/www.chwe.at\/2020\/10\/flutter-flavors\/","datePublished":"2020-10-03T00:00:00+01:00","dateModified":"2020-10-03T00:00:00+01:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Christian Weiss"},"description":""}</script></head><body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":""==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:""==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Christian Weiss">Christian Weiss</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Christian Weiss">Christian Weiss</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Using Flutter flavors to separate the DEV and LIVE environment</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Christian Weiss</a></span>&nbsp;<span class=post-category>included in <a href=/categories/mobile-development/><i class="far fa-folder fa-fw"></i>Mobile Development</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2020-10-03>2020-10-03</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;2669 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;13 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#create-the-git-repository-and-clone-it-locally>Create the Git repository and clone it locally</a></li><li><a href=#create-the-flutter-app>Create the Flutter app</a></li><li><a href=#add-a-flutter-build-configuration-for-each-flavor-in-android-studio>Add a Flutter build configuration for each flavor in Android Studio</a><ul><li><a href=#add-the-build-configurations-to-git>Add the build configurations to Git</a></li></ul></li><li><a href=#set-up-flavors-for-android>Set up flavors for Android</a><ul><li><a href=#add-the-method-channel-in-android-code>Add the method channel in Android code</a></li><li><a href=#add-the-flavor-settings-to-the-android-build-config>Add the flavor-settings to the Android build config</a></li><li><a href=#use-the-app_name-in-the-androidmanifestxml>Use the app_name in the AndroidManifest.xml</a></li><li><a href=#run-the-app-again-on-android>Run the app again on Android</a></li></ul></li><li><a href=#get-the-flavor-in-our-flutter-code>Get the flavor in our Flutter code</a></li><li><a href=#set-up-flavors-for-ios>Set up flavors for iOS</a><ul><li><a href=#create-custom-build-configurations-for-the-flavors>Create custom build configurations for the flavors</a></li><li><a href=#assign-build-configurations-to-custom-schemes>Assign build configurations to custom schemes</a></li><li><a href=#adding-the-method-channel-for-ios>Adding the method channel for iOS</a></li><li><a href=#set-up-the-flavor-value-per-scheme>Set up the flavor value per scheme</a></li><li><a href=#run-the-ios-app>Run the iOS app</a></li></ul></li><li><a href=#set-the-bundle-id-and-app-name-per-flavor-for-ios>Set the bundle id and app name per flavor for iOS</a><ul><li><a href=#set-the-flavor-specific-bundle-identifier>Set the flavor-specific bundle identifier</a></li><li><a href=#set-the-app-name>Set the app name</a></li><li><a href=#run-the-app-again-with-the-dev-and-live-flavors>Run the app again with the dev and live flavors</a></li></ul></li><li><a href=#add-your-own-flavor-specific-settings>Add your own flavor-specific settings</a></li><li><a href=#summary>Summary</a></li></ul></nav></div></div><div class=content id=content><p>These are the requirements for our app:</p><ul><li>Our Flutter app should target iOS and Android.</li><li>We want a DEV version and a LIVE version of our app, each targeting a different API URL.</li><li>Developers should never have to manually change any code to switch between the environments.</li><li>We want to be able to have the DEV app and the LIVE app installed on the same device at the same time.</li></ul><p>The best way to solve these requirements in Flutter is to use <strong>flavors</strong>. There are also some other tutorials for this linked on the official <a href=https://flutter.dev/docs/deployment/flavors target=_blank rel="noopener noreffer">Flutter docs</a> which might be helpful.</p><p>The <a href=https://github.com/cwe1ss/flutter-flavors-ci-cd target=_blank rel="noopener noreffer">code for this guide</a> is stored on GitHub and changes for each section are separate commits that are linked in the section below.</p><p>As we need to change settings in XCode, we need a Mac with Android Studio and XCode for this tutorial.</p><p>You also need to have Flutter installed already. Follow the <a href=https://flutter.dev/docs/get-started/install target=_blank rel="noopener noreffer">Getting started-docs</a> if you still need to install it.</p><p>I&rsquo;m using <code>Flutter v1.22.0</code> for this tutorial.</p><h2 id=create-the-git-repository-and-clone-it-locally>Create the Git repository and clone it locally</h2><p>Create a new Git repository. Mine is: <a href=https://github.com/cwe1ss/flutter-flavors-ci-cd target=_blank rel="noopener noreffer">https://github.com/cwe1ss/flutter-flavors-ci-cd</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>git clone https://github.com/cwe1ss/flutter-flavors-ci-cd.git
</span></span><span class=line><span class=cl><span class=k>cd</span> flutter-flavors-ci-cd/
</span></span></code></pre></td></tr></table></div></div><h2 id=create-the-flutter-app>Create the Flutter app</h2><p>Let&rsquo;s get started by creating the Flutter app, named <code>flutter_flavors</code> via the Flutter CLI directly in the root folder of our repository:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>flutter create --project-name flutter_flavors .
</span></span></code></pre></td></tr></table></div></div><p>Run the app on an Android device/emulator to ensure it works.</p><p><a href=https://github.com/cwe1ss/flutter-flavors-ci-cd/commit/0819ce8b51ddc39d8b7aebf71aea4f2da36a187c target=_blank rel="noopener noreffer">See all changes from this step in the Git commit.</a></p><h2 id=add-a-flutter-build-configuration-for-each-flavor-in-android-studio>Add a Flutter build configuration for each flavor in Android Studio</h2><p>We want to have two flavors called <code>dev</code> and <code>live</code>.</p><p>If you want to launch a flutter app with a flavor, you have to use the <code>--flavor NAME</code> parameter in the <em>Flutter CLI</em>. To automatically start the app with a flavor in <em>Android Studio</em> we need to change the build configurations:</p><ul><li>Find <code>main.dart</code> in the Android Studio top toolbar and select <code>Edit Configurations...</code>. This opens the &ldquo;Run/Debug Configurations&rdquo; window.</li><li>Change the <code>Name:</code> field to <code>dev</code></li><li>For <code>Build flavor:</code> set <code>dev</code> as well.</li><li>Make sure &ldquo;Share through VCS&rdquo; is selected.</li><li>Copy the dev configuration (It&rsquo;s an icon in the top left of the window)</li><li>Change the <code>Name:</code> and <code>Build flavor:</code> values to <code>live</code></li><li>Make sure &ldquo;Share through VCS&rdquo; is selected as well</li><li>Close the dialog. Instead of &ldquo;main.dart&rdquo;, it will now display &ldquo;dev&rdquo; in the top toolbar.</li></ul><p><em>IMPORTANT: Flavor names may not start with &ldquo;test&rdquo; as that&rsquo;s not allowed by Android.</em></p><h3 id=add-the-build-configurations-to-git>Add the build configurations to Git</h3><p>When you select &ldquo;Share through VCS&rdquo;, Android studio will create files in the <code>.idea/runConfigurations</code> folder, however they&rsquo;ll be ignored by the existing .gitignore file.</p><p>We&rsquo;ll therefore add these files manually to Git, so that other users in the team can use it as well:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>git add .idea/runConfigurations/dev.xml -f
</span></span><span class=line><span class=cl>git add .idea/runConfigurations/live.xml -f
</span></span><span class=line><span class=cl>git commit -m &#39;Persist flutter build configurations&#39;
</span></span></code></pre></td></tr></table></div></div><p><a href=https://github.com/cwe1ss/flutter-flavors-ci-cd/commit/36e4eacccf68eb131cd1aa6ab1ac025df56aeb05 target=_blank rel="noopener noreffer">See all changes from this step in the Git commit.</a></p><h2 id=set-up-flavors-for-android>Set up flavors for Android</h2><p>In order to actually use different flavors, we need to set them up in the <code>lib</code>-folder and in each platform (<code>android</code>, <code>ios</code>).</p><p>We&rsquo;ll start with the <code>android</code> part.</p><h3 id=add-the-method-channel-in-android-code>Add the method channel in Android code</h3><p>When the app starts, Flutter needs a way to ask the native platform which flavor it has been started with. To communicate with native code, Flutter uses <code>method channels</code>.</p><p>Go to <code>android/app/src/main/kotlin/com.example.flutter_flavors</code> and replace everything except the first line (the package import) with the following code. This will set up the method channel that returns the <code>BuildConfig.FLAVOR</code> value, which is a built-in value of Android.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>import</span> <span class=nn>androidx.annotation.NonNull;</span>
</span></span><span class=line><span class=cl><span class=k>import</span> <span class=nn>io.flutter.embedding.android.FlutterActivity</span>
</span></span><span class=line><span class=cl><span class=k>import</span> <span class=nn>io.flutter.embedding.engine.FlutterEngine</span>
</span></span><span class=line><span class=cl><span class=k>import</span> <span class=nn>io.flutter.plugin.common.MethodChannel</span>
</span></span><span class=line><span class=cl><span class=k>import</span> <span class=nn>io.flutter.plugins.GeneratedPluginRegistrant</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MainActivity</span><span class=p>:</span> <span class=n>FlutterActivity</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>configureFlutterEngine</span><span class=p>(</span><span class=nd>@NonNull</span> <span class=n>flutterEngine</span><span class=p>:</span> <span class=n>FlutterEngine</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>GeneratedPluginRegistrant</span><span class=p>.</span><span class=n>registerWith</span><span class=p>(</span><span class=n>flutterEngine</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>MethodChannel</span><span class=p>(</span><span class=n>flutterEngine</span><span class=p>.</span><span class=n>dartExecutor</span><span class=p>.</span><span class=n>binaryMessenger</span><span class=p>,</span> <span class=s2>&#34;flavor&#34;</span><span class=p>).</span><span class=n>setMethodCallHandler</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>call</span><span class=p>,</span> <span class=n>result</span> <span class=o>-&gt;</span> <span class=n>result</span><span class=p>.</span><span class=n>success</span><span class=p>(</span><span class=n>BuildConfig</span><span class=p>.</span><span class=n>FLAVOR</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=add-the-flavor-settings-to-the-android-build-config>Add the flavor-settings to the Android build config</h3><p>In Android, the native flavor-specific values are stored in <code>android/app/src/build.gradle</code> via the <code>android.flavorDimensions</code> and <code>android.productFlavors</code> keys.</p><p>We&rsquo;ll use these keys to set up the flavor-specific <code>applicationId</code> and the flavor-specific display name for the app. This is important because we want to be able to have both flavors of the app installed at the same time.</p><p>The <code>applicationId</code> is the unique app id for each flavor in the Google Play store. Once deployed to Google Play, this can not be changed anymore!</p><p>Therefore, add the following two things within the <code>android { ... }</code> section:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gradle data-lang=gradle><span class=line><span class=cl><span class=n>android</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ... all existing things like `sourceSets`, ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>flavorDimensions</span> <span class=s2>&#34;app&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>productFlavors</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>dev</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>dimension</span> <span class=s2>&#34;app&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>applicationId</span> <span class=s2>&#34;at.chwe.flutterflavors.dev&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>resValue</span> <span class=s2>&#34;string&#34;</span><span class=o>,</span> <span class=s2>&#34;app_name&#34;</span><span class=o>,</span> <span class=s2>&#34;DEV Flutter Flavors&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>live</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>dimension</span> <span class=s2>&#34;app&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>applicationId</span> <span class=s2>&#34;at.chwe.flutterflavors&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>resValue</span> <span class=s2>&#34;string&#34;</span><span class=o>,</span> <span class=s2>&#34;app_name&#34;</span><span class=o>,</span> <span class=s2>&#34;Flutter Flavors&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=use-the-app_name-in-the-androidmanifestxml>Use the app_name in the AndroidManifest.xml</h3><p>The <code>applicationId</code> is a well-known key that will already be used when the app is launched with a given flavor.</p><p>However, we&rsquo;ll need to do some more work to get the app_name working: Open <code>android/app/src/main/AndroidManifest.xml</code> and replace the <code>&lt;application android:label="flutter_flavors" /></code> key with <code>&lt;application android:label="@string/app_name" /></code>.</p><h3 id=run-the-app-again-on-android>Run the app again on Android</h3><p>As we&rsquo;re now using new applicationIds, make sure the existing &ldquo;flutter_flavors&rdquo;-app is uninstalled from your device.</p><p>Now, launch the app in Android Studio with the &ldquo;dev&rdquo; build configuration.</p><p>Close the app in the device and check your application list, the app name will now display &ldquo;DEV Flutter Flavors&rdquo;!</p><p>Stop the app in Android Studio, change the build configuration to &ldquo;live&rdquo; and launch the app again.</p><p>You&rsquo;ll now have both flavors of your app installed on your Android device!</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/uploads/2020/flutter_flavors_app_icons_on_android.png data-srcset="/uploads/2020/flutter_flavors_app_icons_on_android.png, /uploads/2020/flutter_flavors_app_icons_on_android.png 1.5x, /uploads/2020/flutter_flavors_app_icons_on_android.png 2x" data-sizes=auto alt=/uploads/2020/flutter_flavors_app_icons_on_android.png title="Both flavors are installed on android"></p><p>Our native Android configuration is now complete.</p><p><a href=https://github.com/cwe1ss/flutter-flavors-ci-cd/commit/099284216215e0a8578518399117d8e28db31b75 target=_blank rel="noopener noreffer">See all changes from this step in the Git commit.</a></p><h2 id=get-the-flavor-in-our-flutter-code>Get the flavor in our Flutter code</h2><p>As described in our requirements, we want to target different API endpoints per flavor so we need a way to get the current flavor in our Flutter code.</p><p>We&rsquo;ll first add a class called <code>FlavorSettings</code> in a new file called <code>lib/flavor_settings.dart</code> that will hold all of our flavor-specific settings that we only need in our Flutter code:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=c1>/// Contains the hard-coded settings per flavor.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>class</span> <span class=nc>FlavorSettings</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=kt>String</span> <span class=n>apiBaseUrl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// TODO Add any additional flavor-specific settings here.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>FlavorSettings</span><span class=p>.</span><span class=n>dev</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=o>:</span> <span class=n>apiBaseUrl</span> <span class=o>=</span> <span class=s1>&#39;https://dev.flutter-flavors.chwe.at&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>FlavorSettings</span><span class=p>.</span><span class=n>live</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=o>:</span> <span class=n>apiBaseUrl</span> <span class=o>=</span> <span class=s1>&#39;https://flutter-flavors.chwe.at&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Next, we&rsquo;ll use this in <code>main.dart</code>, where we&rsquo;ll read the flavor via our method channel from the native platform and we&rsquo;ll create the corresponding <code>FlavorSettings</code>-object. We&rsquo;ll also have to make our <code>main</code>-method async for that.</p><p>When done, your <code>main.dart</code> should contain the following code before the <code>class MyApp extends StatelessWidget {</code> line:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=k>import</span> <span class=s1>&#39;package:flutter/material.dart&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>import</span> <span class=s1>&#39;package:flutter/services.dart&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>import</span> <span class=s1>&#39;flavor_settings.dart&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Future</span><span class=o>&lt;</span><span class=kt>void</span><span class=o>&gt;</span> <span class=n>main</span><span class=p>()</span> <span class=kd>async</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// NOTE: This is required for accessing the method channel before runApp().
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>WidgetsFlutterBinding</span><span class=p>.</span><span class=n>ensureInitialized</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>settings</span> <span class=o>=</span> <span class=kd>await</span> <span class=n>_getFlavorSettings</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=n>print</span><span class=p>(</span><span class=s1>&#39;API URL </span><span class=si>${</span><span class=n>settings</span><span class=p>.</span><span class=n>apiBaseUrl</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>runApp</span><span class=p>(</span><span class=n>MyApp</span><span class=p>());</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Future</span><span class=o>&lt;</span><span class=n>FlavorSettings</span><span class=o>&gt;</span> <span class=n>_getFlavorSettings</span><span class=p>()</span> <span class=kd>async</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>String</span> <span class=n>flavor</span> <span class=o>=</span> <span class=kd>await</span> <span class=kd>const</span> <span class=n>MethodChannel</span><span class=p>(</span><span class=s1>&#39;flavor&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>invokeMethod</span><span class=o>&lt;</span><span class=kt>String</span><span class=o>&gt;</span><span class=p>(</span><span class=s1>&#39;getFlavor&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>print</span><span class=p>(</span><span class=s1>&#39;STARTED WITH FLAVOR </span><span class=si>$</span><span class=n>flavor</span><span class=s1>&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>flavor</span> <span class=o>==</span> <span class=s1>&#39;dev&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>FlavorSettings</span><span class=p>.</span><span class=n>dev</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>flavor</span> <span class=o>==</span> <span class=s1>&#39;live&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>FlavorSettings</span><span class=p>.</span><span class=n>live</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>throw</span> <span class=n>Exception</span><span class=p>(</span><span class=s2>&#34;Unknown flavor: </span><span class=si>$</span><span class=n>flavor</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ... class MyApp extends StatelessWidget {
</span></span></span></code></pre></td></tr></table></div></div><p>Run the app with <code>dev</code> build configuration and look at the console output. It will display the following statements:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>I/flutter ( 4458): STARTED WITH FLAVOR dev
</span></span><span class=line><span class=cl>I/flutter ( 4458): API URL https://dev.flutter-flavors.chwe.at
</span></span></code></pre></td></tr></table></div></div><p>Switch to the <code>live</code> build configuration and run your app again. This time, the console will display the following statements:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>I/flutter ( 4615): STARTED WITH FLAVOR live
</span></span><span class=line><span class=cl>I/flutter ( 4615): API URL https://flutter-flavors.chwe.at
</span></span></code></pre></td></tr></table></div></div><p>That&rsquo;s it! We can now access the current flavor from within Flutter and we can have flavor-specific settings.</p><p>You can pass the <code>FlavorSettings</code>-instance down to your widgets manually, or you can use e.g. the <code>provider</code>-package to access it via dependency injection in your widgets.</p><p><a href=https://github.com/cwe1ss/flutter-flavors-ci-cd/commit/64ee8642551702dd4d36f15c5f788befe8c6bc9a target=_blank rel="noopener noreffer">See all changes from this step in the Git commit.</a></p><h2 id=set-up-flavors-for-ios>Set up flavors for iOS</h2><p>Unfortunately, setting up flavors in iOS is more complex and we&rsquo;ll have to use XCode and its UI for most of the steps.</p><p>Let&rsquo;s try building our app with a flavor for iOS now to see, what kind of error we get:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>flutter build ios --flavor dev
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The Xcode project does not define custom schemes. You cannot use the --flavor option.
</span></span></code></pre></td></tr></table></div></div><p>This means, that on iOS we have to rely on a feature called &ldquo;custom schemes&rdquo; to represent our flutter flavors. Setting them up requires multiple steps.</p><h3 id=create-custom-build-configurations-for-the-flavors>Create custom build configurations for the flavors</h3><p>Let&rsquo;s open our <code>ios</code>-folder in XCode and start by creating our custom build configurations:</p><ul><li>Make sure the root &ldquo;Runner&rdquo; node is selected in XCode</li><li>In the main window, select the &ldquo;Runner&rdquo; node below &ldquo;PROJECT&rdquo; (NOT below TARGETS)</li><li>Select the &ldquo;Info&rdquo; tab</li><li>In the &ldquo;Configurations&rdquo; section, do the following:<ul><li>Rename &ldquo;Debug&rdquo; to &ldquo;Debug-dev&rdquo;</li><li>Rename &ldquo;Release&rdquo; to &ldquo;Release-dev&rdquo;</li><li>Rename &ldquo;Profile&rdquo; to &ldquo;Profile-dev&rdquo;</li><li>Duplicate &ldquo;Debug-dev&rdquo; and rename it to &ldquo;Debug-live&rdquo;</li><li>Duplicate &ldquo;Release-dev&rdquo; and rename it to &ldquo;Release-live&rdquo;</li><li>Duplicate &ldquo;Profile-dev&rdquo; and rename it to &ldquo;Profile-live&rdquo;</li></ul></li></ul><p>This means, for every flavor, we need a separate &ldquo;Debug&rdquo;, &ldquo;Release&rdquo; & &ldquo;Profile&rdquo; configuration.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/uploads/2020/flutter_flavors_ios_configurations.png data-srcset="/uploads/2020/flutter_flavors_ios_configurations.png, /uploads/2020/flutter_flavors_ios_configurations.png 1.5x, /uploads/2020/flutter_flavors_ios_configurations.png 2x" data-sizes=auto alt=/uploads/2020/flutter_flavors_ios_configurations.png title="Configurations in XCode"></p><h3 id=assign-build-configurations-to-custom-schemes>Assign build configurations to custom schemes</h3><p>Now we can set up the actual &ldquo;custom schemes&rdquo; by doing the following:</p><ul><li>Make sure the root &ldquo;Runner&rdquo; node is selected in XCode</li><li>Select &ldquo;Product -> Scheme -> Manage Schemes&mldr;&rdquo; in the main toolbar.</li><li>To get the &ldquo;dev&rdquo; scheme:<ul><li>Select the &ldquo;Runner&rdquo; scheme, click on the settings-icon in the top left and select &ldquo;Duplicate&rdquo;</li><li>Rename the scheme to &ldquo;dev&rdquo;</li><li>Make sure &ldquo;Shared&rdquo; is selected</li><li>Close the dialog</li></ul></li><li>To get the &ldquo;live&rdquo; scheme:<ul><li>Select the &ldquo;Runner&rdquo; scheme again, click on the settings-icon in the top left and select &ldquo;Duplicate&rdquo;</li><li>Rename the scheme to &ldquo;live&rdquo;</li><li>For each of the sections (&ldquo;Run&rdquo;, &ldquo;Test&rdquo;, &ldquo;Profile&rdquo;, &ldquo;Analyze&rdquo;, &ldquo;Archive&rdquo;) on the left, change the build configuration to the corresponding &ldquo;-live&rdquo; version.</li><li>Make sure &ldquo;Shared&rdquo; is selected</li><li>Close the dialog</li></ul></li></ul><p><img class=lazyload src=/svg/loading.min.svg data-src=/uploads/2020/flutter_flavors_ios_live_scheme.png data-srcset="/uploads/2020/flutter_flavors_ios_live_scheme.png, /uploads/2020/flutter_flavors_ios_live_scheme.png 1.5x, /uploads/2020/flutter_flavors_ios_live_scheme.png 2x" data-sizes=auto alt=/uploads/2020/flutter_flavors_ios_live_scheme.png title="live scheme in XCode"></p><p>Back in the &ldquo;schemes&rdquo; list, you can now delete the existing &ldquo;Runner&rdquo; scheme. This should result in the list looking like this:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/uploads/2020/flutter_flavors_ios_schemes.png data-srcset="/uploads/2020/flutter_flavors_ios_schemes.png, /uploads/2020/flutter_flavors_ios_schemes.png 1.5x, /uploads/2020/flutter_flavors_ios_schemes.png 2x" data-sizes=auto alt=/uploads/2020/flutter_flavors_ios_schemes.png title="scheme list in XCode"></p><h3 id=adding-the-method-channel-for-ios>Adding the method channel for iOS</h3><p>Building the app now shoud succeed, however when you try to run it, it will fail with the following error:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[VERBOSE-2:ui_dart_state.cc(177)] Unhandled Exception: MissingPluginException(No implementation found for method getFlavor on channel flavor)
</span></span></code></pre></td></tr></table></div></div><p>That&rsquo;s because we haven&rsquo;t yet implemented the method channel that Flutter uses to get the current flavor from the native platform.</p><p>To add this, we need to add some code to the <code>application()</code>-function of the <code>Runner/AppDelegate.swift</code>-file in XCode. The finished file should look like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-swift data-lang=swift><span class=line><span class=cl><span class=kd>import</span> <span class=nc>UIKit</span>
</span></span><span class=line><span class=cl><span class=kd>import</span> <span class=nc>Flutter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>@UIApplicationMain</span>
</span></span><span class=line><span class=cl><span class=kr>@objc</span> <span class=kd>class</span> <span class=nc>AppDelegate</span><span class=p>:</span> <span class=n>FlutterAppDelegate</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>override</span> <span class=kd>func</span> <span class=nf>application</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=kc>_</span> <span class=n>application</span><span class=p>:</span> <span class=n>UIApplication</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>didFinishLaunchingWithOptions</span> <span class=n>launchOptions</span><span class=p>:</span> <span class=p>[</span><span class=n>UIApplication</span><span class=p>.</span><span class=n>LaunchOptionsKey</span><span class=p>:</span> <span class=nb>Any</span><span class=p>]?</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span> <span class=p>-&gt;</span> <span class=nb>Bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>GeneratedPluginRegistrant</span><span class=p>.</span><span class=n>register</span><span class=p>(</span><span class=n>with</span><span class=p>:</span> <span class=kc>self</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nv>controller</span> <span class=p>=</span> <span class=n>window</span><span class=p>.</span><span class=n>rootViewController</span> <span class=k>as</span><span class=p>!</span> <span class=n>FlutterViewController</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nv>flavorChannel</span> <span class=p>=</span> <span class=n>FlutterMethodChannel</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>name</span><span class=p>:</span> <span class=s>&#34;flavor&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>binaryMessenger</span><span class=p>:</span> <span class=n>controller</span><span class=p>.</span><span class=n>binaryMessenger</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>flavorChannel</span><span class=p>.</span><span class=n>setMethodCallHandler</span><span class=p>({(</span><span class=n>call</span><span class=p>:</span> <span class=n>FlutterMethodCall</span><span class=p>,</span> <span class=n>result</span><span class=p>:</span> <span class=p>@</span><span class=n>escaping</span> <span class=n>FlutterResult</span><span class=p>)</span> <span class=p>-&gt;</span> <span class=nb>Void</span> <span class=k>in</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Note: this method is invoked on the UI thread</span>
</span></span><span class=line><span class=cl>        <span class=kd>let</span> <span class=nv>flavor</span> <span class=p>=</span> <span class=n>Bundle</span><span class=p>.</span><span class=n>main</span><span class=p>.</span><span class=n>infoDictionary</span><span class=p>?[</span><span class=s>&#34;App - Flavor&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=p>(</span><span class=n>flavor</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>super</span><span class=p>.</span><span class=n>application</span><span class=p>(</span><span class=n>application</span><span class=p>,</span> <span class=n>didFinishLaunchingWithOptions</span><span class=p>:</span> <span class=n>launchOptions</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>This will set up a method channel handler that reads the current flavor from a <code>Bundle.main.infoDictionary</code> with a key called <code>App - Flavor</code>.</p><h3 id=set-up-the-flavor-value-per-scheme>Set up the flavor value per scheme</h3><p>The <code>Bundle.main.infoDictionary</code> from before refers to the <code>Runner/Info.plist</code> file and <code>App - Flavor</code> is a custom key that we have to add there manually next.</p><p>So open the <code>Runner/Info.plist</code> file in XCode and and add a new row with the following settings:</p><ul><li>Key: <code>App - Flavor</code></li><li>Type: <code>String</code></li><li>Value <code>$(APP_FLAVOR)</code></li></ul><p>We now have the key but we still don&rsquo;t have the actual flavor-specific values per scheme. To add them, we now have to do the following:</p><ul><li>Select the root &ldquo;Runner&rdquo; node in your XCode project structure</li><li>Select &ldquo;Runner&rdquo; below <strong>TARGETS</strong></li><li>Select the &ldquo;Build settings&rdquo; tab</li><li>Click on the + to add a new User-defined setting</li><li>Name it <code>APP_FLAVOR</code></li><li>Expand the node by clicking on the little arrow on the left of the row and add the actual flavor value to each build configuration:<ul><li>Debug-dev: <code>dev</code></li><li>Debug-live: <code>live</code></li><li>Profile-dev: <code>dev</code></li><li>Profile-live: <code>live</code></li><li>Release-dev: <code>dev</code></li><li>Release-live: <code>live</code></li></ul></li></ul><p>When done, it should look like this:
<img class=lazyload src=/svg/loading.min.svg data-src=/uploads/2020/flutter_flavors_ios_flavor_setting.png data-srcset="/uploads/2020/flutter_flavors_ios_flavor_setting.png, /uploads/2020/flutter_flavors_ios_flavor_setting.png 1.5x, /uploads/2020/flutter_flavors_ios_flavor_setting.png 2x" data-sizes=auto alt=/uploads/2020/flutter_flavors_ios_flavor_setting.png title="flavor setting in XCode"></p><h3 id=run-the-ios-app>Run the iOS app</h3><p>We should now be able to select the &ldquo;dev&rdquo;-scheme in the top navigation bar of XCode and run the app.</p><p><em>NOTE: If you get weird build errors from XCode, try switching between the dev/live schemes or try restarting XCode or running the iOS app from Android Studio.</em></p><p>You should now see similar console output like for the Android app:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2020-10-03 14:44:05.525493+0200 Runner[26055:336596] flutter: STARTED WITH FLAVOR dev
</span></span><span class=line><span class=cl>2020-10-03 14:44:05.526672+0200 Runner[26055:336596] flutter: API URL https://dev.flutter-flavors.chwe.at
</span></span></code></pre></td></tr></table></div></div><p><a href=https://github.com/cwe1ss/flutter-flavors-ci-cd/commit/608246ea5f948f2a63dc1d7450a77468428a4fc4 target=_blank rel="noopener noreffer">See all changes from this step in the Git commit.</a></p><p>Great, we now have set up our flavors for iOS as well!</p><h2 id=set-the-bundle-id-and-app-name-per-flavor-for-ios>Set the bundle id and app name per flavor for iOS</h2><p>You might have noticed that the app name on the iPhone still is &ldquo;flutter_flavors&rdquo;. Also, when you run both flavors, you still only have one app on your phone:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/uploads/2020/flutter_flavors_ios_wrong_appname.png data-srcset="/uploads/2020/flutter_flavors_ios_wrong_appname.png, /uploads/2020/flutter_flavors_ios_wrong_appname.png 1.5x, /uploads/2020/flutter_flavors_ios_wrong_appname.png 2x" data-sizes=auto alt=/uploads/2020/flutter_flavors_ios_wrong_appname.png title="wrong app name on iPhone"></p><p>Remember, that for Android we&rsquo;ve set those values in the <code>build.gradle</code> file.</p><p>To make things flavor-specific in iOS, we need to do something similar like we&rsquo;ve done for the flavor value itself, where we&rsquo;ve configured a key in <code>Info.plist</code> and then set different values in the &ldquo;TARGETS/Runner -> Build Settings&rdquo; tab.</p><h3 id=set-the-flavor-specific-bundle-identifier>Set the flavor-specific bundle identifier</h3><p>The <code>Info.plist</code> file already contains a key named <code>Bundle identifier</code> that already contains a dynamic value <code>$(PRODUCT_BUNDLE_IDENTIFIER)</code>, so we don&rsquo;t have to create another entry in this file.</p><p>Instead, we just have to modify this key in the the build settings:</p><ul><li>In XCode, select the root &ldquo;Runner&rdquo; node in the project explorer</li><li>Select &ldquo;Runner&rdquo; below <strong>TARGETS</strong></li><li>Go to the &ldquo;Build Settings&rdquo; tab</li><li>In the &ldquo;Packaging&rdquo; section, find the &ldquo;Product Bundle Identifier&rdquo; key</li><li>Expand the key by clicking on the small arrow on the left</li><li>Set the value per build configuration:<ul><li>Debug-dev: <code>at.chwe.flutterflavors.dev</code></li><li>Debug-live: <code>at.chwe.flutterflavors</code></li><li>Profile-dev: <code>at.chwe.flutterflavors.dev</code></li><li>Profile-live: <code>at.chwe.flutterflavors</code></li><li>Release-dev: <code>at.chwe.flutterflavors.dev</code></li><li>Release-live: <code>at.chwe.flutterflavors</code></li></ul></li></ul><p><img class=lazyload src=/svg/loading.min.svg data-src=/uploads/2020/flutter_flavors_ios_bundle_id.png data-srcset="/uploads/2020/flutter_flavors_ios_bundle_id.png, /uploads/2020/flutter_flavors_ios_bundle_id.png 1.5x, /uploads/2020/flutter_flavors_ios_bundle_id.png 2x" data-sizes=auto alt=/uploads/2020/flutter_flavors_ios_bundle_id.png title="bundle id per ios config"></p><h3 id=set-the-app-name>Set the app name</h3><p>To have separate display names per flavor, do the following:</p><ul><li>In XCode, select the root &ldquo;Runner&rdquo; node in the project explorer</li><li>Select &ldquo;Runner&rdquo; below <strong>TARGETS</strong></li><li>Select the &ldquo;Info&rdquo; tab</li><li>Change the value of the key <code>Bundle name</code> to <code>$(APP_NAME)</code>.</li><li>Go to the &ldquo;Build Settings&rdquo; tab</li><li>Add a new User-Defined setting</li><li>Name it <code>APP_NAME</code></li><li>Expand the APP_NAME-node by clicking on the small arrow on the left side of the node.</li><li>Set the value per build configuration:<ul><li>Debug-dev: <code>DEV Flutter Flavors</code></li><li>Debug-live: <code>Flutter Flavors</code></li><li>Profile-dev: <code>DEV Flutter Flavors</code></li><li>Profile-live: <code>Flutter Flavors</code></li><li>Release-dev: <code>DEV Flutter Flavors</code></li><li>Release-live: <code>Flutter Flavors</code></li></ul></li></ul><p><img class=lazyload src=/svg/loading.min.svg data-src=/uploads/2020/flutter_flavors_ios_app_name.png data-srcset="/uploads/2020/flutter_flavors_ios_app_name.png, /uploads/2020/flutter_flavors_ios_app_name.png 1.5x, /uploads/2020/flutter_flavors_ios_app_name.png 2x" data-sizes=auto alt=/uploads/2020/flutter_flavors_ios_app_name.png title="app name per ios config"></p><h3 id=run-the-app-again-with-the-dev-and-live-flavors>Run the app again with the dev and live flavors</h3><p>Delete the existing &ldquo;flutter_flavors&rdquo; app from your iPhone and run it again with each flavor. You should now have both apps with the correct name on your phone:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/uploads/2020/flutter_flavors_ios_app_icons.png data-srcset="/uploads/2020/flutter_flavors_ios_app_icons.png, /uploads/2020/flutter_flavors_ios_app_icons.png 1.5x, /uploads/2020/flutter_flavors_ios_app_icons.png 2x" data-sizes=auto alt=/uploads/2020/flutter_flavors_ios_app_icons.png title="app icons on the iPhone"></p><p><a href=https://github.com/cwe1ss/flutter-flavors-ci-cd/commit/6b4ead183f8b3f9128fa2b4d24b277056b747909 target=_blank rel="noopener noreffer">See all changes from this step in the Git commit.</a></p><h2 id=add-your-own-flavor-specific-settings>Add your own flavor-specific settings</h2><p>If you need another flavor-specific setting, you have to know if it is a platform-specific setting, that needs to be integrated directly into the <code>android</code> and <code>ios</code> folders or if it is a setting that is only required in your Flutter code.</p><p>For platform-specific settings, the above guides for setting the app name and bundle id should help.</p><p>For settings that you only need in your Flutter-code, just add them to the <code>FlavorSettings</code>-class that we&rsquo;ve created above.</p><h2 id=summary>Summary</h2><p>We&rsquo;ve now set up our Flutter project to have multiple flavors. We use those flavors to separate our app environments (DEV & LIVE). This way we don&rsquo;t need to e.g. manually comment out code to switch our API URL or any other settings. We can also have both versions installed side by side, which makes development and support much easier as we can develop on the DEV version while we still can use the LIVE version which is deployed to the stores.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2020-10-03</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/2020/10/flutter-flavors/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://www.chwe.at/2020/10/flutter-flavors/ data-title="Using Flutter flavors to separate the DEV and LIVE environment" data-via=cwe1ss><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://www.chwe.at/2020/10/flutter-flavors/ data-title="Using Flutter flavors to separate the DEV and LIVE environment"><i class="fab fa-hacker-news fa-fw"></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://www.chwe.at/2020/10/flutter-flavors/><i class="fab fa-reddit fa-fw"></i></a><a href=javascript:void(0); title="Share on Evernote" data-sharer=evernote data-url=https://www.chwe.at/2020/10/flutter-flavors/ data-title="Using Flutter flavors to separate the DEV and LIVE environment"><i class="fab fa-evernote fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2015/09/find-missing-projects-with-powershell/ class=prev rel=prev title="Find missing projects with PowerShell"><i class="fas fa-angle-left fa-fw"></i>Find missing projects with PowerShell</a>
<a href=/2020/10/zero-downtime-updates-with-aspnet-core/ class=next rel=next title="Simple zero-downtime updates with ASP.NET Core and health checks">Simple zero-downtime updates with ASP.NET Core and health checks<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.104.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Christian Weiss</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.fathom=window.fathom||function(){(fathom.q=fathom.q||[]).push(arguments)},fathom("set","siteId","KUYCRMLC"),fathom("trackPageview")</script><script type=text/javascript src=https://cdn.usefathom.com/tracker.js async id=fathom-script></script></body></html>